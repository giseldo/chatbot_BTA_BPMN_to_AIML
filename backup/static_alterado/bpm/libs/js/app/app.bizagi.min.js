function Exception(a){this.message=a,this.name="UserException"}var Bizagi={App:{Static:{},Views:{},Model:{}},Util:{}};Bizagi.Util.getHost=function(){var a,b=$("body").attr("debug"),c=document.URL,d=[],e=Bizagi.Util.validateHost();return e.isServer?a="true"===b?"ExportWeb/index-debug.html#":"ExportWeb/index.html#":e.isLocal?(c=c.replace(/(^(file\:)(\/)*([A-Z]\:\/))/g,""),d=c.split(".html"),a=d[0]+".html#"):alert(Bizagi.Util.getResource("cannotVisualize")),a},Bizagi.Util.validateHost=function(){var a=document.URL,b=a.match(/(http:\/\/)(.*)/g),c=a.match(/(https:\/\/)(.*)/g),d=a.match(/(localhost)(.*)/g),e=a.match(/(dev\-)(.*)/g),f=a.match(/^(file\:)(.*)/g),g={isServer:!1,isLocal:!1};return b||c||d||e?g.isServer=!0:f&&(g.isLocal=!0),g},Bizagi.Util.getVariables=function(a){var b="";for(var c in a)b+=c+":"+a[c]+";";return b},Bizagi.Util.serializeNames=function(a){var b=a.replace(/[ !@\#\$%\^&\*\(\)\-\=\_\+\/\.]/gi,"");return b=b.replace(/[áÁ]/gi,"a"),b=b.replace(/[éÉ]/gi,"e"),b=b.replace(/[íÍ]/gi,"i"),b=b.replace(/[óÓ]/gi,"o"),b=b.replace(/[úÚ]/gi,"u"),b=b.replace(/[ñÑ]/gi,"n"),b=b.toLowerCase()},Bizagi.Util.hasMainProcessId=function(a){var b=a.mainProcessId?!0:!1;return b},Bizagi.Util.getMainProcess=function(a,b){var c=Bizagi.Util.validateDiagaramInModel(a,b);return c.page},Bizagi.Util.getTemplates=function(){var a={};return $('script[type="text/x-jquery-tmpl"]').each(function(){var b=$(this);a[b.attr("id")]=$.trim(b[0].innerHTML).replace(/(\r\n|\n|\r)/g," "),$.template(b.attr("id"),a[b.attr("id")])}),a},Bizagi.Util.getTemplate=function(a){return $("#"+a).template()},Bizagi.Util.renderPerformers=function(a,b,c){for(var d={showed:[],hidden:[]},e=a.length>b,f=0;f<a.length;f++)b>=f?d.showed.push(a[f]):d.hidden.push(a[f]);return d.isLarge=e,d},Bizagi.Util.renderDescriptionPreview=function(a,b){var c,d=a,e=!0,f=b,g=$("<div>");return g.html(a),d=g.text(),d=$.trim(d),d.length>f?c=d.substring(0,f).split(" ").slice(0,-1).join(" ")+"...":(c=d,e=!1),($("img",g).length||$("ul",g).length||$("table",g).length)&&(e=!0),{descriptionComplete:Bizagi.Util.preserveHTML(a),descriptionSummary:c,isLarge:e}},Bizagi.Util.renderSubPagesRecursive=function(a,b,c){var d,e,f;if(d=c?"List":"",e=$("#"+a+d).html(),f=$("<div/>").append($.tmpl(e,b)),_.has(b,"subPages"))for(var g=0;g<b.subPages.length;g++)c?($(".biz-ex-subPages",f).remove(),f.append(Bizagi.Util.renderSubPagesRecursive(a,b.subPages[g],c))):$(".biz-ex-subPages",f).append(Bizagi.Util.renderSubPagesRecursive(a,b.subPages[g],c));return f.html()},Bizagi.Util.preserveHTML=function(a){var b=a,c=$("<div>"+a+"</div>");return PublishWebAttributes.preserveHTML?($("a",c).attr("target","blank"),b=c.html()):b=c.text(),b},Bizagi.Util.serializeResourceURL=function(a){var b="";return a&&(b=a.replace(/(\\)/g,"/")),b},Bizagi.Util.getResource=function(a){var b=a;return _.isEmpty(Bizagi.AppModel.texts)||Bizagi.AppModel.texts[a]&&(b=Bizagi.AppModel.texts[a]),b},Bizagi.Util.validateLength=function(a){var b=!1,c=a;if("string"==typeof a){var d=$("<div>");d.html(a),c=d.text()}return b=_.isEmpty(c)},Bizagi.Util.validateForValidTasks=function(a){var b=!1;return("ExclusiveGateway"===a||"SubProcess"===a||"AbstractTask"===a||"UserTask"===a||"ServiceTask"===a||"ReceiveTask"===a||"SendTask"===a||"ScriptTask"===a||"ManualTask"===a||"BusinessRuleTask"===a)&&(b=!0),b},Bizagi.Util.validateForEmpty=function(a){var b=!1,c=a.properties&&0!==a.properties.length;return a.pageElements||c||a.description&&0!==a.description.length||(b=!0),b},Bizagi.Util.validateDiagaramInModel=function(a,b,c){var d,e;d={isValid:!1},e=a;var f={isValid:!1},g=c?c:"pages",h={};if("pages"===g){for(var i=0;i<e.length;i++)if(e[i].id===b){h={page:e[i],isValid:!0},_.extend(f,h);break}h.isValid||(g="subpages")}var j={};if("subpages"===g){for(var k=0;k<e.length;k++)if(_.has(e[k],"subPages")&&(j=Bizagi.Util.findInSubpages(e[k].subPages,b),j.isValid)){_.extend(f,j);break}j.isValid?j.isValid&&j.page.isSubprocessPage&&(_.extend(f,j),g="elements"):g="elements"}var l={};if("elements"===g){for(var m=0;m<e.length;m++)if(_.has(e[m],"elements")&&(l=Bizagi.Util.findInElements(e[m].elements,b),l.isValid)){_.extend(f,l);break}if(!l.isValid)for(var n=0;n<e.length;n++)if(_.has(e[n],"subPages")&&(l=Bizagi.Util.findInElementsInSubpages(e[n].subPages,b,!0),l.isValid)){_.extend(f,l);break}l.isValid&&j.isValid&&(_.extend(j.page,l.page),_.extend(f,j))}return f},Bizagi.Util.findInSubpages=function(a,b,c){for(var d={isValid:!1},e=0;e<a.length;e++){if(a[e].id===b){d={page:a[e],isValid:!0};break}if(_.has(a[e],"subPages")&&(d=Bizagi.Util.findInSubpages(a[e].subPages,b),d.isValid))break}return d},Bizagi.Util.findInElementsInSubpages=function(a,b){for(var c={isValid:!1},d=0;d<a.length;d++)if(_.has(a[d],"subPages"))c=Bizagi.Util.findInElementsInSubpages(a[d].subPages,b);else if(c=Bizagi.Util.findInElements(a[d].elements,b),c.isValid)break;return c},Bizagi.Util.findInElements=function(a,b){for(var c={isValid:!1},d=0;d<a.length;d++){if(a[d].id===b){c={page:a[d],isValid:!0};break}if(_.has(a[d],"pageElements")&&(c=Bizagi.Util.findInPageElements(a[d].pageElements,b),c.isValid))break}return c},Bizagi.Util.findInPageElements=function(a,b){for(var c={isValid:!1},d=0;d<a.length;d++)if(a[d].id===b){c={page:a[d],isValid:!0};break}return c},Bizagi.Util.getSubProcesses=function(a){var b=0,c=a.subPages;if(c)for(var d=0;d<c.length;d++)c[d].isSubprocessPage&&b++,b+=Bizagi.Util.getSubProcesses(c[d]);return b},Bizagi.Util.getSubProcessesObject=function(a){var b=[],c=a.subPages;if(c){for(var d=0;d<c.length;d++)b.push(Bizagi.Util.getSubProcessesObject(c[d]));return b}return a},Bizagi.Util.validatePropertyResource=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;h=/(^[a-zA-Z]\:\\)(.*)((\.[a-z]{3})$)/g,i=/\.([0-9a-z]+)(?:[\?#]|$)/i,k=/((www.)|(localhost)|(http))/g,f=b.match(h),g=_.isEmpty(f)?b:f[0],j=b.match(i),l=j[1]?j[1]:"",webPage=b.match(k),m=_.isEmpty(webPage)?!1:!0,e=d="",isImage="jpg"===l||"png"===l||"gif"===l;var n=c.replace(/\s\/\\/gi,""),o='<div class="'+n+Math.floor(11*Math.random())+'"></div>';return isImage&&$.when(Bizagi.Util.imageExist(g)).then(function(a){var b='<img src="'+g+'" class="biz-ex-image"/><span>'+Bizagi.Util.getResource("localResource")+"</span>";_.isEmpty(f)?e=b:(g=g.replace(/(\\)/gi,"/"),e="<a href=\"javascript:window.open('file:///"+g+'\');" class="biz-ex-document-'+l+' biz-ex-external" target="_blank">'+b+"</a>"),$("."+o).append(e)},function(){var a="<span>"+Bizagi.Util.getResource("unavailableResource")+"</span>";e=m?'<a href="'+g+'" class="biz-ex-webpage" target="_blank">'+a+"</a>":a,$("."+o).append(e)}),o},Bizagi.Util.imageExist=function(a){var b=new Image,c=new jQuery.Deferred;return b.onload=function(a){c.resolve(!0)},b.onerror=function(a){c.reject()},b.src=a,c.promise()},Bizagi.Util.getTableAsListByColumn=function(a){for(var b=[],c=0;c<a.headers.length;c++){nObject={header:"",list:[]},nObject.header=a.headers[c];for(var d=0;d<a.table.length;d++)nObject.list.push(a.table[d][c]);b.push(nObject)}var e=$.tmpl("PropertiesDLViewTmpl",{list:b}),f=$("<div/>").append(e);return $("a",f).attr("target","blank"),f.html()},Bizagi.Util.getTableAsListByRow=function(a){var b=$.tmpl("PropertiesDLRowViewTmpl",a),c=$("<div/>").append(b);return $("a",c).attr("target","blank"),c.html()},Bizagi.Util.getZoomJson=function(){return Bizagi.Zoomer},Bizagi.Util.cleanSelector=function(a){return a.replace(/(\.|\#)/gi,"")},Bizagi.Util.serializeURL=function(a,b){var c,d="",e=Bizagi.Util.validateHost();return e.isServer?(c=b?b:"/",d=a.replace(/(\\)/g,c)):(c=b?b:"\\",d=a.replace(/(\/)/g,c)),d},Bizagi.Util.createRule=function(a){var b="",c=Bizagi.Util.validateHost();return b=c.isServer?a.replace(/(\\)/g,"/"):a.replace(/(\/)/g,"\\")},Bizagi.Util.overridePlugins=function(){$.fn.show=function(){return this.each(function(){$(this).removeClass("biz-ex-is-hidden").addClass("biz-ex-is-visible")})},$.fn.hide=function(){return this.each(function(){$(this).addClass("biz-ex-is-hidden").removeClass("biz-ex-is-visible")})},$.fn.active=function(a){return this.each(function(){a?$(this).addClass("biz-ex-active-ancestors active-ancestors"):$(this).addClass("biz-ex-active active")})},$.fn.inactive=function(){return this.each(function(){$(this).removeClass("biz-ex-active active"),$(this).removeClass("biz-ex-active-ancestors active-ancestors")})},$.fn.columns=function(a){return this.each(function(){$(this).addClass("large-"+a+" columns")})},$.fn.clearColumns=function(a){return this.each(function(){$(this).removeClass("large-"+a+" columns")})},$.fn.replaceColumns=function(a,b){return this.each(function(){if("*"===a)for(var c=0;12>=c;c++)$(this).removeClass("large-"+c);else $(this).removeClass("large-"+a);$(this).addClass("large-"+b)})},$.fn.overflow=function(a){return this.each(function(){var b="biz-ex-overflow";a&&(b=b+"-"+a),$(this).addClass(b)})},$.fn.absolute=function(a){return this.each(function(){var b="biz-ex-absolute";a&&(b=b+"-"+a),$(this).addClass(b)})},$.fn.clearOverflow=function(a){return this.each(function(){var b="biz-ex-overflow";a&&(b=b+"-"+a),$(this).removeClass(b)})},$.fn.validateImage=function(a){var b=this;return b.options=a,this.each(function(){var a=$(this);b.options.originalImage=a.attr("src"),b.tryOuts=0;var c=function(){var d=new Image,e=b.options.originalImage;d.onload=function(){a.attr("src",e)},d.onerror=function(){if(b.tryOuts<1)b.tryOuts++,c();else{d.className=d.className+"biz-ex-image-not-found";Bizagi.Util.getResource("resourceNotFound")+b.options.originalImage;a.attr("src",b.options.unavailableImage)}},d.src=e};c()})},$.fn.carousel=function(a){var b=this;return this.init=function(){var b=$(this);b.attr("role","carousel");var c=Math.round($("li:first",b).outerWidth()),d=$("li",b).length;$("li",b).width(c);var e=(c*a.thumbs,c*Math.round(d/2)+10),f=$("ul",b),g=$(".biz-ex-carousel-container",b);f.data("options",a),f.width(e),g.overflow("important").height(f.height()),f.absolute().css("left",0),b.data("page",0);var h=$("li:first",b).outerWidth();b.on("click","span.biz-ex-icon-back",function(){var a=b.data("page")+1,c=h*a;0>=c&&f.animate({left:c},500,function(){b.data("page",a)})}),b.on("click","span.biz-ex-icon-next",function(){var a=b.data("page")-1,d=h*a,g=-1*e+c;d>=g&&f.animate({left:d},500,function(){b.data("page",a)})}),b.addClass("biz-ex-carusel-ready")},this.refresh=function(){var c=$(this);c.attr("role","carousel"),c.attr("role-updated","true"),$("ul",c).clearOverflow().attr("style",""),$("li",c).attr("style",""),c.removeClass("biz-ex-carusel-ready"),a=$("ul",c).data("options"),c.off("click"),b.init()},"string"!=typeof a?this.init():this[a]()}},Bizagi.Util.offCanvas=function(){var a=$("#topMenu"),b="click.fndtn";a.length>0&&a.css("margin-top",-1*a.height());var c=$("#sidebarButton");c.length>0&&$("#sidebarButton").on(b,function(a){a.preventDefault(),$("body").toggleClass("active")}),$(window).resize(function(){$("body").removeClass("active")});var d=$("#menuButton");d.length>0&&$("#menuButton").on(b,function(a){a.preventDefault(),$("body").toggleClass("active-menu")});var e=$("#switchPanels");e.length>0&&$("#switchPanels dd").on(b,function(a){a.preventDefault();var b=$(this).children("a").attr("href"),c=$(b).index();$(this).toggleClass("active").siblings().removeClass("active"),$(b).parent().css("left",-100*c+"%")}),$("#nav li a").on(b,function(a){a.preventDefault();var b=$(this).attr("href"),c=$(b);$("html, body").animate({scrollTop:c.offset().top},300)})};